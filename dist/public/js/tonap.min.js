var container,itemsHolder,itemsWrapper,itemsCount,itemsNodes,map=null,marker=null,markerJumped=!1,googleScriptLoaded=!1,products=[{}],intervalId=null,intervalStarted=!1,choosedProduct={},orderObject=[],getOrderObjectFromStorage=localStorage.getItem("orderObject"),orderObjectFromStorage=JSON.parse(getOrderObjectFromStorage),orderInProgress={title:"",isSterile:!1,package:1,boxSize:1,boxCount:0,id:""},socket=null,timer=0,start=!0,stopIn=1e3,stopTime=0,stop=!1,timeTillStop=0;function updateItemsHolder(){setTimeout(function(){container=$("#pills-tabContent").find(".active"),itemsHolder=container.find(".productRowContainer"),itemsWrapper=itemsHolder[0].children[0],itemsCount=itemsWrapper.childElementCount,itemsNodes=itemsWrapper.childNodes},400)}function revealProducts(){$(".productShowAllContainer > button").on("click",function(e){var t=e.currentTarget,o=$(t).find("i"),n=$(t).parent(".productShowAllContainer").find("p");setTimeout(function(){if(o.hasClass("fa-caret-down")){for(console.log(itemsNodes),i=0;i<itemsNodes.length;i++)$(itemsNodes[i]).show("slow");o.removeClass("fa-caret-down").addClass("fa-caret-up"),n.html("Zobraziť menej")}else{for(i=0;i<itemsNodes.length;i++)i<4?$(itemsNodes[i]).show("slow"):(console.log("hidujem"),$(itemsNodes[i]).hide("slow"));o.removeClass("fa-caret-up").addClass("fa-caret-down"),n.html("Zobraziť všetky produkty")}},10)})}function goto(e){scrollIt(document.querySelector(e),600,"easeOutQuad")}function loadMap(){var e,t,o={lat:48.72601,lng:21.28979},n={center:new google.maps.LatLng(o.lat,o.lng),disableDefaultUI:!0,zoom:15,mapTypeControl:!1,fullscreenControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},r={url:window.location.origin+"/assets/images/icons/logofooter.png",scaledSize:new google.maps.Size(42,60),labelOrigin:new google.maps.Point(21,80),labelAnchor:new google.maps.Point(0,0)};marker=new google.maps.Marker({position:o,animation:google.maps.Animation.DROP,icon:r,label:{color:"#0669bb",fontWeight:"bold",fontSize:"14px",text:"Tonap s. r. o."},map:map}),map=new google.maps.Map(document.getElementById("map"),n),e=function(e){var t=JSON.parse(e),o=new google.maps.StyledMapType(t,{name:"Map"});map.mapTypes.set("styled_map",o),map.setMapTypeId("styled_map")},(t=new XMLHttpRequest).overrideMimeType("application/json"),t.open("GET",window.location.origin+"/assets/js/map.json",!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&e(t.responseText)},t.send(null)}function scrollPage(){window.addEventListener("scroll",function(e){var t=window.pageYOffset;if(580<=t?intervalStarted&&(stop=start=!0,timeTillStop=(stopTime=timer+stopIn)-timer,cancelAnimationFrame(intervalId),intervalId=null):intervalStarted&&null===intervalId&&counterInterval(),950<=t&&this.document.getElementById("map")){if(null===map&&!googleScriptLoaded){var o=document.createElement("script");googleScriptLoaded=!0,o.onload=function(){},o.async=!0,o.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGuAMy2poB-W_gNCuKoKejHIh3LeyDZ_E&callback=loadMap",this.document.body.insertBefore(o,document.body.getElementsByTagName("script")[document.body.getElementsByTagName("script").length-1])}1125<=t&&marker&&map&&googleScriptLoaded&&!markerJumped&&(marker.setMap(map),markerJumped=!0)}})}function startCounter(){function e(e,t,r,d){var a=document.getElementById(e),i=r-t,o=Math.abs(Math.floor(d/i));o=Math.max(o,50);var l,c=(new Date).getTime()+d;function n(){var e=(new Date).getTime(),t=Math.max((c-e)/d,0),o=Math.round(r-t*i),n=Math.ceil(o).toLocaleString("en-EG");a.innerHTML=n,o==r&&clearInterval(l)}l=setInterval(n,o),n()}e("count-1",3297585,12e6,4e3),setTimeout(function(){e("count-2",3297585,9e6,3500)},500),setTimeout(function(){e("count-3",3297585,33e5,3e3)},1e3),setTimeout(counterInterval,4100)}function counterInterval(){intervalId=requestAnimationFrame(function e(t){t=t,start?(stopTime=t+stopIn,$(".count").each(function(e,t){var o=parseInt(t.innerHTML.replace(/,/g,""));o=(o+=1).toLocaleString("en-EG"),t.innerHTML=o}),start=!(intervalStarted=!0)):stopTime<=t&&(stop=!0),timeTillStop=stopTime-t,stop?(stop=!(start=!0),timeTillStop=stopTime=0,intervalId=requestAnimationFrame(e)):requestAnimationFrame(e)})}function getProducts(){var t=new XMLHttpRequest;t.open("GET",window.location.origin+"/product/",!0),t.onreadystatechange=function(){if(4==t.readyState&&"200"==t.status){var e=JSON.parse(t.response);fillProducts(products=e.data),getURL()}},t.send(null)}function fillProducts(e){window.location.pathname.indexOf("online-objednavka");for(var t=0;t<e.length;t++){if(1==e[t].category){(n=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center cursor-pointer")).attr("onclick","orderProduct('"+e[t]._id+"')");var o=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[t].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[t].title+'">').attr("data-src",e[t].imageFilesData[0].url).appendTo(n),o.appendTo(n),$("<p></p>").text("Cena / TODO").appendTo(n),n.appendTo("#productKelimky")}if(2==e[t].category){(n=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center cursor-pointer")).attr("onclick","orderProduct('"+e[t]._id+"')");o=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[t].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[t].title+'">').attr("data-src",e[t].imageFilesData[0].url).appendTo(n),o.appendTo(n),$("<p></p>").text("Cena / TODO").appendTo(n),n.appendTo("#productOdberniky")}if(3==e[t].category){var n;(n=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center cursor-pointer")).attr("onclick","orderProduct('"+e[t]._id+"')");o=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[t].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[t].title+'">').attr("data-src",e[t].imageFilesData[0].url).appendTo(n),o.appendTo(n),$("<p></p>").text("Cena / TODO").appendTo(n),n.appendTo("#productSkumavky")}}}function orderProduct(e){for(var t=0;t<products.length;t++)products[t]._id==e&&(document.location.href.indexOf("online-objednavka")<0?(document.getElementById("navigationOrder").innerHTML="Pridať do košíka",choosedProduct=products[t],console.log(choosedProduct),document.getElementById("productModalMainImage").setAttribute("src",choosedProduct.imageFilesData[0].url),document.getElementById("mainTitle").innerHTML=choosedProduct.title,document.getElementById("productDescription").innerHTML=choosedProduct.description,document.getElementById("productHeight").innerHTML="Výška: "+choosedProduct.height+" mm",document.getElementById("productDepth").innerHTML="Priemer: "+choosedProduct.gauge+" mm",document.getElementById("productVolume").innerHTML="Objem: "+choosedProduct.volume+" ml",document.getElementById("productWeight").innerHTML="Váha: "+choosedProduct.weight+" g",document.getElementById("navigationOrder").setAttribute("onclick","fillOrder('"+products[t]._id+"')")):(choosedProduct=products[t],console.log(choosedProduct),document.getElementById("productModalMainImage").setAttribute("src",choosedProduct.imageFilesData[0].url),document.getElementById("mainTitle").innerHTML=choosedProduct.title,document.getElementById("productDescription").innerHTML=choosedProduct.description,document.getElementById("productHeight").innerHTML="Výška: "+choosedProduct.height+" mm",document.getElementById("productDepth").innerHTML="Priemer: "+choosedProduct.gauge+" mm",document.getElementById("productVolume").innerHTML="Objem: "+choosedProduct.volume+" ml",document.getElementById("productWeight").innerHTML="Váha: "+choosedProduct.weight+" g",document.getElementById("editOrder").setAttribute("onclick","fillOrder('"+products[t]._id+"')")),$("#productModal").modal())}function showProduct(){"kelimky"==$("#orderselect").val()?($("#productKelimky").show(),$("#productKelimky").css("display","flex")):$("#productKelimky").hide(),"odberniky"==$("#orderselect").val()?($("#productOdberniky").show(),$("#productOdberniky").css("display","flex")):$("#productOdberniky").hide(),"skumavky"==$("#orderselect").val()?($("#productSkumavky").show(),$("#productSkumavky").css("display","flex")):$("#productSkumavky").hide()}function showProductMainpage(){"kelimky"==$("#mainselect").val()?($("#productKelimky").show(),$("#productKelimky").css("display","flex")):$("#productKelimky").hide(),"odberniky"==$("#mainselect").val()?($("#productOdberniky").show(),$("#productOdberniky").css("display","flex")):$("#productOdberniky").hide(),"skumavky"==$("#mainselect").val()?($("#productSkumavky").show(),$("#productSkumavky").css("display","flex")):$("#productSkumavky").hide()}function goToOrder(e){window.location="/online-objednavka?id="+e}function getURL(){}function fillOrder(e){orderInProgress.title=document.getElementById("mainTitle").innerHTML,orderInProgress.id=e,orderInProgress.image=document.getElementById("productModalMainImage").src,orderObject.push(orderInProgress),console.log(orderObject),localStorage.setItem("orderObject",JSON.stringify(orderObject)),console.log(localStorage.getItem("orderObject")),orderInProgress={},$("#productModal").modal("toggle")}function updateDetail(){var e;console.log(orderObjectFromStorage),document.getElementById("detailOrder").innerHTML="",console.log(orderObjectFromStorage);for(var t=0;t<orderObjectFromStorage.length;t++){var o=document.createElement("button"),n=document.createElement("button"),r=document.createElement("i"),d=document.createElement("i");r.className="fas fa-trash ml-3",d.className="fas fa-pen",o.type="button",o.appendChild(r),o.setAttribute("onclick","deleteOrder("+t+");"),n.type="button",n.appendChild(d),n.setAttribute("onclick","editOrder("+t+");");var a=document.createElement("td");a.className="text-center",e=$("<tr></tr>");var i=$('<td class="border-left-0"></td>').appendTo(e);$("<img>").attr("src",orderObjectFromStorage[t].image).appendTo(i),$("<td></td>").html(orderObjectFromStorage[t].title).appendTo(e),$("<td></td>").html("Varianta").appendTo(e),$("<td></td>").html("0,00 €").appendTo(e),$('<td class="border-left-0"></td>').html('<span class="font-weight-bold">'+orderObjectFromStorage[t].boxCount+" ks.</span>").appendTo(e),$("<td></td>").html("0,00 €").appendTo(e),$(a).addClass("border-right-0"),$(a).append(n),$(a).append(o).appendTo(e),e.appendTo(document.getElementById("detailOrder"))}}function editOrder(e){orderProduct(orderObjectFromStorage[e].id),document.getElementById("editOrder").innerHTML="Zmeniť objednávku",document.getElementById("editOrder").setAttribute("onclick","updateOrder("+e+")")}function updateOrder(e){orderObject[e].title=document.getElementById("orderMainTitle").innerHTML,document.getElementById("sterilizovany").checked&&(orderObject[e].isSterile=!0),document.getElementById("nesterilizovany").checked&&(orderObject[e].isSterile=!1),orderObject[e].package=$("input:radio[name='Balenie']:checked").val(),orderObject[e].boxSize=$("input:radio[name='Krabica']:checked").val(),orderObject[e].boxCount=document.getElementById("modalPackageCount").value,updateDetail(),$("#orderModal").modal("toggle")}function deleteOrder(e){orderObjectFromStorage.splice(e,1),updateDetail()}function sendOrder(){event.preventDefault();var e={};e.city=document.getElementById("companyCity").value,e.psc=document.getElementById("companyPSC").value,e.street=document.getElementById("companyAdress").value;var t={};t.city=document.getElementById("deliveryCity").value,t.psc=document.getElementById("deliveryPSC").value,t.street=document.getElementById("deliveryAdress").value;var o={};o.billingAddress=e,o.company=document.getElementById("company").value,o.deliveryAddress=t,o.name=document.getElementById("name").value,o.email=document.getElementById("email").value,o.phone=document.getElementById("phone").value,o.ico=document.getElementById("ico").value,o.message=document.getElementById("message").value,o.products=orderObject;var n=JSON.stringify(o);$.ajax({type:"POST",url:window.location.origin+"/order",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){socket.emit("order created"),$(document.getElementById("successOrder")).modal("show")}})}function sendEmail(){var e={};event.preventDefault(),e.name=document.getElementById("contactName").value,e.email=document.getElementById("contactEmail").value,e.subject=document.getElementById("contactSubject").value,e.message=document.getElementById("contactMessage").value,jsonData=JSON.stringify(e),$.ajax({type:"POST",url:window.location.origin+"/email/send",data:jsonData,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){$(document.getElementById("successEmail")).modal("show")}})}function scrollIt(e,r,d,a){var i={easeOutQuad:function(e){return e*(2-e)}},l=window.pageYOffset,c="now"in window.performance?performance.now():(new Date).getTime(),t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),o=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight,n="number"==typeof e?e:e.offsetTop-90,s=Math.round(t-n<o?t-o:n);if("requestAnimationFrame"in window==!1)return window.scroll(0,s),void(a&&a());!function e(){var t="now"in window.performance?performance.now():(new Date).getTime(),o=Math.min(1,(t-c)/r),n=i[d](o);window.scroll(0,Math.ceil(n*(s-l)+l)),window.pageYOffset!==s?requestAnimationFrame(e):a&&a()}()}window.onload=function(){for(revealProducts(),scrollPage(),getProducts(),window.location.href.indexOf("online-objednavka")<0&&setTimeout(startCounter,1e3),container=$("#pills-tabContent").find(".active"),itemsHolder=container.find(".productRowContainer"),itemsWrapper=itemsHolder[0].children[0],console.log(container),console.log(itemsHolder),itemsCount=itemsWrapper.childElementCount,itemsNodes=itemsWrapper.childNodes,i=0;i<itemsNodes.length;i++)i<4?$(itemsNodes[i]).show("slow"):$(itemsNodes[i]).hide("slow")},"function"==typeof io&&(socket=io()),1<window.location.href.indexOf("online-objednavka")&&(updateDetail(),console.log("online-objednavka"));