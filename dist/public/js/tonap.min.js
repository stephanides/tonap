var map=null,marker=null,markerJumped=!1,googleScriptLoaded=!1,products=[{}],intervalId=null,intervalStarted=!1,choosedProduct={},orderObject=[],orderInProgress={title:"",isSterile:!1,package:1,boxSize:1,boxCount:0,id:""},socket=null,timer=0,start=!0,stopIn=1e3,stopTime=0,stop=!1,timeTillStop=0;function revealProducts(){$(".productShowAllContainer > button").on("click",function(e){var t=e.currentTarget,o=$(t).find("i"),n=$(t).parent(".productShowAllContainer").find("p");setTimeout(function(){o.hasClass("fa-caret-down")?($("#orderProduct").find(".productRowContainer:nth-child(2), .productRowContainer:nth-child(3)").show("slow"),o.removeClass("fa-caret-down").addClass("fa-caret-up"),n.html("Zobraziť menej")):($("#orderProduct").find(".productRowContainer:nth-child(2), .productRowContainer:nth-child(3)").hide("slow"),o.removeClass("fa-caret-up").addClass("fa-caret-down"),n.html("Zobraziť všetky produkty"))},10)})}function goto(e){scrollIt(document.querySelector(e),600,"easeOutQuad")}function loadMap(){var e,t,o={center:new google.maps.LatLng(48.635896,21.714897),disableDefaultUI:!0,zoom:15,mapTypeControl:!1,fullscreenControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},n={url:window.location.origin+"/assets/images/icons/logofooter.png",scaledSize:new google.maps.Size(42,60),labelOrigin:new google.maps.Point(21,80),labelAnchor:new google.maps.Point(0,0)};marker=new google.maps.Marker({position:{lat:48.635896,lng:21.714897},animation:google.maps.Animation.DROP,icon:n,label:{color:"#0669bb",fontWeight:"bold",fontSize:"14px",text:"Tonap s. r. o."},map:map}),map=new google.maps.Map(document.getElementById("map"),o),e=function(e){var t=JSON.parse(e),o=new google.maps.StyledMapType(t,{name:"Map"});map.mapTypes.set("styled_map",o),map.setMapTypeId("styled_map")},(t=new XMLHttpRequest).overrideMimeType("application/json"),t.open("GET",window.location.origin+"/assets/js/map.json",!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&e(t.responseText)},t.send(null)}function scrollPage(){window.addEventListener("scroll",function(e){var t=window.pageYOffset;if(580<=t?intervalStarted&&(stop=start=!0,timeTillStop=(stopTime=timer+stopIn)-timer,cancelAnimationFrame(intervalId),intervalId=null):intervalStarted&&null===intervalId&&counterInterval(),950<=t&&this.document.getElementById("map")){if(null===map&&!googleScriptLoaded){var o=document.createElement("script");googleScriptLoaded=!0,o.onload=function(){},o.async=!0,o.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGuAMy2poB-W_gNCuKoKejHIh3LeyDZ_E&callback=loadMap",this.document.body.insertBefore(o,document.body.getElementsByTagName("script")[document.body.getElementsByTagName("script").length-1])}1125<=t&&marker&&map&&googleScriptLoaded&&!markerJumped&&(marker.setMap(map),markerJumped=!0)}})}function startCounter(){function e(e,t,d,r){var l=document.getElementById(e),a=d-t,o=Math.abs(Math.floor(r/a));o=Math.max(o,50);var i,c=(new Date).getTime()+r;function n(){var e=(new Date).getTime(),t=Math.max((c-e)/r,0),o=Math.round(d-t*a),n=Math.ceil(o).toLocaleString("en-EG");l.innerHTML=n,o==d&&clearInterval(i)}i=setInterval(n,o),n()}e("count-1",3297585,12e6,4e3),setTimeout(function(){e("count-2",3297585,9e6,3500)},500),setTimeout(function(){e("count-3",3297585,33e5,3e3)},1e3),setTimeout(counterInterval,4100)}function counterInterval(){intervalId=requestAnimationFrame(function e(t){t=t,start?(stopTime=t+stopIn,$(".count").each(function(e,t){var o=parseInt(t.innerHTML.replace(/,/g,""));o=(o+=1).toLocaleString("en-EG"),t.innerHTML=o}),start=!(intervalStarted=!0)):stopTime<=t&&(stop=!0),timeTillStop=stopTime-t,stop?(stop=!(start=!0),timeTillStop=stopTime=0,intervalId=requestAnimationFrame(e)):requestAnimationFrame(e)})}function getProducts(){var t=new XMLHttpRequest;t.open("GET",window.location.origin+"/product/",!0),t.onreadystatechange=function(){if(4==t.readyState&&"200"==t.status){var e=JSON.parse(t.response);fillProducts(products=e.data),getURL()}},t.send(null)}function fillProducts(e){for(var t=-1<window.location.pathname.indexOf("online-objednavka"),o=0;o<e.length;o++){if(1==e[o].category){var n=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center"),d=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[o].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[o].title+'">').attr("data-src",e[o].imageFilesData[0].url).appendTo(n),$("<p></p>").text(e[o].sterile&&e[o].notSterile?"Sterilné/Nesterilné":e[o].sterile?"Sterilné":"Nesterilné").appendTo(n),d.appendTo(n),$("<button></button>").text(t?"Objednať":"Detail produktu").attr("onclick","orderProduct('"+e[o]._id+"')").appendTo(n),n.appendTo("#productKelimky")}if(2==e[o].category){n=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center"),d=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[o].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[o].title+'">').attr("data-src",e[o].imageFilesData[0].url).appendTo(n),$("<p></p>").text(e[o].sterile&&e[o].notSterile?"Sterilné/Nesterilné":e[o].sterile?"Sterilné":"Nesterilné").appendTo(n),d.appendTo(n),$("<button></button>").text(t?"Objednať":"Detail produktu").attr("onclick","orderProduct('"+e[o]._id+"')").appendTo(n),n.appendTo("#productOdberniky")}if(3==e[o].category){n=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center"),d=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[o].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[o].title+'">').attr("data-src",e[o].imageFilesData[0].url).appendTo(n),$("<p></p>").text(e[o].sterile&&e[o].notSterile?"Sterilné/Nesterilné":e[o].sterile?"Sterilné":"Nesterilné").appendTo(n),d.appendTo(n),$("<button></button>").text(t?"Objednať":"Detail produktu").attr("onclick","orderProduct('"+e[o]._id+"')").appendTo(n),n.appendTo("#productSkumavky")}}}function orderProduct(e){document.getElementById("navigationOrder").innerHTML=-1<window.location.href.indexOf("online-objednavka")?"Pridať do objednávky":"Prejsť do objednávky";for(var t=0;t<products.length;t++)products[t]._id==e&&(document.location.href.indexOf("online-objednavka")<0?(choosedProduct=products[t],document.getElementById("productModalMainImage").setAttribute("src",choosedProduct.imageFilesData[0].url),document.getElementById("mainTitle").innerHTML=choosedProduct.title,document.getElementById("isSterilized").innerHTML=choosedProduct.sterile&&choosedProduct.notSterile?"Sterilné/Nesterilné":choosedProduct.sterile?"Sterilné":"Nesterilné",document.getElementById("productDescription").innerHTML=choosedProduct.description,document.getElementById("productHeight").innerHTML="Výška: "+choosedProduct.height+" mm",document.getElementById("productDepth").innerHTML="Priemer: "+choosedProduct.gauge+" mm",document.getElementById("productVolume").innerHTML="Objem: "+choosedProduct.volume+" ml",document.getElementById("productWeight").innerHTML="Váha: "+choosedProduct.weight+" g",document.getElementById("navigationOrder").setAttribute("onclick","goToOrder('"+products[t]._id+"')"),$("#productModal").modal()):(choosedProduct=products[t],document.getElementById("orderModalMainImage").setAttribute("src",choosedProduct.imageFilesData[0].url),document.getElementById("orderMainTitle").innerHTML=choosedProduct.title,document.getElementById("isOrderSterilized").innerHTML=choosedProduct.sterile&&choosedProduct.notSterile?"Sterilné/Nesterilné":choosedProduct.sterile?"Sterilné":"Nesterilné",choosedProduct.sterile&&!choosedProduct.notSterile||choosedProduct.notSterile&&choosedProduct.sterile?(document.getElementById("sterilizovany").checked=!0,chooseSterility(0)):!choosedProduct.sterile&&choosedProduct.notSterile&&(document.getElementById("nesterilizovany").checked=!0,chooseSterility(1)),choosedProduct.sterile?document.getElementById("modalSterilne").style.display="inline-flex":document.getElementById("modalSterilne").style.display="none",choosedProduct.notSterile?document.getElementById("modalNesterilne").style.display="inline-flex":document.getElementById("modalNesterilne").style.display="none",document.getElementById("navigationOrder").setAttribute("onclick","fillOrder('"+products[t]._id+"')"),$("#orderModal").modal()))}function chooseSterility(e){0===e&&(document.getElementById("nonPackageType").style.display="none",document.getElementById("nonPackage").style.display="none",document.getElementById("modalPackageType1").style.display="inline-block",document.getElementById("modalPackageType2").style.display="inline-block",document.getElementById("modalPackage1").style.display="inline-block",document.getElementById("modalPackage2").style.display="inline-block",null!=choosedProduct&&(document.getElementById("balenie1").value=choosedProduct.sterileProductMinCount,document.getElementById("labelBalenie1").innerHTML="Po "+choosedProduct.sterileProductMinCount+"ks",document.getElementById("balenie2").value=choosedProduct.sterileProductMaxCount,document.getElementById("labelBalenie2").innerHTML="Po "+choosedProduct.sterileProductMaxCount+"ks",document.getElementById("krabica1").value=choosedProduct.sterileProductMinPackageCount,document.getElementById("package1").innerHTML="Po "+choosedProduct.sterileProductMinPackageCount+"ks",document.getElementById("krabica2").value=choosedProduct.sterileProductMaxPackageCount,document.getElementById("package2").innerHTML="Po "+choosedProduct.sterileProductMaxPackageCount+"ks")),1===e&&(document.getElementById("nonPackageType").style.display="none",document.getElementById("nonPackage").style.display="none",document.getElementById("modalPackageType1").style.display="inline-block",document.getElementById("modalPackageType2").style.display="inline-block",document.getElementById("modalPackage1").style.display="inline-block",document.getElementById("modalPackage2").style.display="inline-block",null!=choosedProduct&&(document.getElementById("balenie1").value=choosedProduct.notSterileProductMinCount,document.getElementById("labelBalenie1").innerHTML="Po "+choosedProduct.notSterileProductMinCount+"ks",document.getElementById("balenie2").value=choosedProduct.notSterileProductMaxCount,document.getElementById("labelBalenie2").innerHTML="Po "+choosedProduct.notSterileProductMaxCount+"ks",document.getElementById("krabica1").value=choosedProduct.notSterileProductMinPackageCount,document.getElementById("package1").innerHTML="Po "+choosedProduct.notSterileProductMinPackageCount+"ks",document.getElementById("krabica2").value=choosedProduct.notSterileProductMaxPackageCount,document.getElementById("package2").innerHTML="Po "+choosedProduct.notSterileProductMaxPackageCount+"ks"))}function showProduct(){"kelimky"==$("#orderselect").val()?($("#productKelimky").show(),$("#productKelimky").css("display","flex")):$("#productKelimky").hide(),"odberniky"==$("#orderselect").val()?($("#productOdberniky").show(),$("#productOdberniky").css("display","flex")):$("#productOdberniky").hide(),"skumavky"==$("#orderselect").val()?($("#productSkumavky").show(),$("#productSkumavky").css("display","flex")):$("#productSkumavky").hide()}function showProductMainpage(){"kelimky"==$("#mainselect").val()?($("#productKelimky").show(),$("#productKelimky").css("display","flex")):$("#productKelimky").hide(),"odberniky"==$("#mainselect").val()?($("#productOdberniky").show(),$("#productOdberniky").css("display","flex")):$("#productOdberniky").hide(),"skumavky"==$("#mainselect").val()?($("#productSkumavky").show(),$("#productSkumavky").css("display","flex")):$("#productSkumavky").hide()}function goToOrder(e){window.location="/online-objednavka?id="+e}function getURL(){if(-1!==document.location.href.indexOf("id="))for(var e=window.location.href,t=e.substring(e.lastIndexOf("=")+1),o=0;o<products.length;o++)products[o]._id==t&&(choosedProduct=products[o],document.getElementById("orderModalMainImage").setAttribute("src",choosedProduct.imageFilesData[0].url),document.getElementById("orderMainTitle").innerHTML=choosedProduct.title,document.getElementById("isOrderSterilized").innerHTML=choosedProduct.sterile&&choosedProduct.notSterile?"Sterilné/Nesterilné":choosedProduct.sterile?"Sterilné":"Nesterilné",choosedProduct.sterile?document.getElementById("modalSterilne").style.display="inline-flex":document.getElementById("modalSterilne").style.display="none",choosedProduct.notSterile?document.getElementById("modalNesterilne").style.display="inline-flex":document.getElementById("modalNesterilne").style.display="none",document.getElementById("navigationOrder").setAttribute("onclick","fillOrder('"+products[o]._id+"')"),choosedProduct.sterile&&!choosedProduct.notSterile?(document.getElementById("sterilizovany").checked=!0,chooseSterility(0)):!choosedProduct.sterile&&choosedProduct.notSterile?(document.getElementById("nesterilizovany").checked=!0,chooseSterility(1)):choosedProduct.sterile&&choosedProduct.notSterile&&(document.getElementById("sterilizovany").checked=!0,chooseSterility(0)),$("#orderModal").modal())}function fillOrder(e){orderInProgress.title=document.getElementById("orderMainTitle").innerHTML,document.getElementById("sterilizovany").checked&&(orderInProgress.isSterile=!0),document.getElementById("nesterilizovany").checked&&(orderInProgress.isSterile=!1),orderInProgress.package=$("input:radio[name='Balenie']:checked").val(),orderInProgress.boxSize=$("input:radio[name='Krabica']:checked").val(),orderInProgress.boxCount=document.getElementById("modalPackageCount").value,orderInProgress.id=e,orderObject.push(orderInProgress),orderInProgress={},updateDetail(),$("#orderModal").modal("toggle")}function updateDetail(){var e;document.getElementById("detailOrder").innerHTML="";for(var t=0;t<orderObject.length;t++){var o=document.createElement("button"),n=document.createElement("button"),d=document.createElement("i"),r=document.createElement("i");d.className="fas fa-trash ml-3",r.className="fas fa-pen",o.type="button",o.appendChild(d),o.setAttribute("onclick","deleteOrder("+t+");"),n.type="button",n.appendChild(r),n.setAttribute("onclick","editOrder("+t+");");var l=orderObject[t].isSterile?"Sterilný":"Nesterilný",a=document.createElement("td");a.className="text-center",e=$("<tr></tr>"),$("<td></td>").html(orderObject[t].title).appendTo(e),$('<td class="border-right-0"></td>').html(l).appendTo(e),$('<td class="border-left-0"></td>').html('<span class="font-weight-bold">'+orderObject[t].boxCount+" ks.</span>").appendTo(e),$(a).append(n),$(a).append(o).appendTo(e),e.appendTo(document.getElementById("detailOrder"))}}function editOrder(e){orderProduct(orderObject[e].id),document.getElementById("modalPackageCount").value=orderObject[e].value,document.getElementById("navigationOrder").innerHTML="Zmeniť objednávku",document.getElementById("navigationOrder").setAttribute("onclick","updateOrder("+e+")")}function updateOrder(e){orderObject[e].title=document.getElementById("orderMainTitle").innerHTML,document.getElementById("sterilizovany").checked&&(orderObject[e].isSterile=!0),document.getElementById("nesterilizovany").checked&&(orderObject[e].isSterile=!1),orderObject[e].package=$("input:radio[name='Balenie']:checked").val(),orderObject[e].boxSize=$("input:radio[name='Krabica']:checked").val(),orderObject[e].boxCount=document.getElementById("modalPackageCount").value,updateDetail(),$("#orderModal").modal("toggle")}function deleteOrder(e){orderObject.splice(e,1),updateDetail()}function sendOrder(){event.preventDefault();var e={};e.city=document.getElementById("companyCity").value,e.psc=document.getElementById("companyPSC").value,e.street=document.getElementById("companyAdress").value;var t={};t.city=document.getElementById("deliveryCity").value,t.psc=document.getElementById("deliveryPSC").value,t.street=document.getElementById("deliveryAdress").value;var o={};o.billingAddress=e,o.company=document.getElementById("company").value,o.deliveryAddress=t,o.name=document.getElementById("name").value,o.email=document.getElementById("email").value,o.phone=document.getElementById("phone").value,o.ico=document.getElementById("ico").value,o.message=document.getElementById("message").value,o.products=orderObject;var n=JSON.stringify(o);$.ajax({type:"POST",url:window.location.origin+"/order",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){socket.emit("order created"),$(document.getElementById("successOrder")).modal("show")}})}function sendEmail(){var e={};event.preventDefault(),e.name=document.getElementById("contactName").value,e.email=document.getElementById("contactEmail").value,e.subject=document.getElementById("contactSubject").value,e.message=document.getElementById("contactMessage").value,jsonData=JSON.stringify(e),$.ajax({type:"POST",url:window.location.origin+"/email/send",data:jsonData,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){$(document.getElementById("successEmail")).modal("show")}})}function scrollIt(e,d,r,l){var a={easeOutQuad:function(e){return e*(2-e)}},i=window.pageYOffset,c="now"in window.performance?performance.now():(new Date).getTime(),t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),o=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight,n="number"==typeof e?e:e.offsetTop-90,s=Math.round(t-n<o?t-o:n);if("requestAnimationFrame"in window==!1)return window.scroll(0,s),void(l&&l());!function e(){var t="now"in window.performance?performance.now():(new Date).getTime(),o=Math.min(1,(t-c)/d),n=a[r](o);window.scroll(0,Math.ceil(n*(s-i)+i)),window.pageYOffset!==s?requestAnimationFrame(e):l&&l()}()}window.onload=function(){revealProducts(),scrollPage(),getProducts(),setTimeout(startCounter,1e3)},"function"==typeof io&&(socket=io());