var totalProductPrice,map=null,marker=null,markerJumped=!1,googleScriptLoaded=!1,products=[{}],intervalId=null,intervalStarted=!1,choosedProduct={};if(null!=localStorage.getItem("orderObject")){var getOrderObjectFromStorage=localStorage.getItem("orderObject"),orderObject=JSON.parse(getOrderObjectFromStorage);getSum(),console.log(orderObject)}else{orderObject=[];getSum()}var countSelect,variantId,container,itemsHolder,itemsWrapper,itemsCount,itemsNodes,orderInProgress={title:"",price:0,count:0,id:""},socket=null,timer=0,start=!0,stopIn=1e3,stopTime=0,stop=!1,timeTillStop=0;function updateItemsHolder(){}function revealProducts(){$(".productShowAllContainer > button").on("click",function(e){var t=e.currentTarget,o=$(t).find("i"),n=$(t).parent(".productShowAllContainer").find("p");setTimeout(function(){if(o.hasClass("fa-caret-down")){for(i=0;i<itemsNodes.length;i++)$(itemsNodes[i]).show("slow");o.removeClass("fa-caret-down").addClass("fa-caret-up"),n.html("Zobraziť menej")}else{for(i=0;i<itemsNodes.length;i++)i<4?$(itemsNodes[i]).show("slow"):$(itemsNodes[i]).hide("slow");o.removeClass("fa-caret-up").addClass("fa-caret-down"),n.html("Zobraziť všetky produkty")}},100)})}function goto(e){scrollIt(document.querySelector(e),600,"easeOutQuad")}function loadMap(){var e,t,o={lat:48.72601,lng:21.28979},n={center:new google.maps.LatLng(o.lat,o.lng),disableDefaultUI:!0,zoom:15,mapTypeControl:!1,fullscreenControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP},r={url:window.location.origin+"/assets/images/icons/logofooter.png",scaledSize:new google.maps.Size(42,60),labelOrigin:new google.maps.Point(21,80),labelAnchor:new google.maps.Point(0,0)};marker=new google.maps.Marker({position:o,animation:google.maps.Animation.DROP,icon:r,label:{color:"#0669bb",fontWeight:"bold",fontSize:"14px",text:"Tonap s. r. o."},map:map}),map=new google.maps.Map(document.getElementById("map"),n),e=function(e){var t=JSON.parse(e),o=new google.maps.StyledMapType(t,{name:"Map"});map.mapTypes.set("styled_map",o),map.setMapTypeId("styled_map")},(t=new XMLHttpRequest).overrideMimeType("application/json"),t.open("GET",window.location.origin+"/assets/js/map.json",!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&e(t.responseText)},t.send(null)}function scrollPage(){window.addEventListener("scroll",function(e){var t=window.pageYOffset;if(580<=t?intervalStarted&&(stop=start=!0,timeTillStop=(stopTime=timer+stopIn)-timer,cancelAnimationFrame(intervalId),intervalId=null):intervalStarted&&null===intervalId&&counterInterval(),950<=t&&this.document.getElementById("map")){if(null===map&&!googleScriptLoaded){var o=document.createElement("script");googleScriptLoaded=!0,o.onload=function(){},o.async=!0,o.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGuAMy2poB-W_gNCuKoKejHIh3LeyDZ_E&callback=loadMap",this.document.body.insertBefore(o,document.body.getElementsByTagName("script")[document.body.getElementsByTagName("script").length-1])}1125<=t&&marker&&map&&googleScriptLoaded&&!markerJumped&&(marker.setMap(map),markerJumped=!0)}})}function startCounter(){function e(e,t,r,d){var a=document.getElementById(e),c=r-t,o=Math.abs(Math.floor(d/c));o=Math.max(o,50);var i,l=(new Date).getTime()+d;function n(){var e=(new Date).getTime(),t=Math.max((l-e)/d,0),o=Math.round(r-t*c),n=Math.ceil(o).toLocaleString("en-EG");a.innerHTML=n,o==r&&clearInterval(i)}i=setInterval(n,o),n()}e("count-1",3297585,12e6,4e3),setTimeout(function(){e("count-2",3297585,9e6,3500)},500),setTimeout(function(){e("count-3",3297585,33e5,3e3)},1e3),setTimeout(counterInterval,4100)}function counterInterval(){intervalId=requestAnimationFrame(function e(t){t=t,start?(stopTime=t+stopIn,$(".count").each(function(e,t){var o=parseInt(t.innerHTML.replace(/,/g,""));o=(o+=1).toLocaleString("en-EG"),t.innerHTML=o}),start=!(intervalStarted=!0)):stopTime<=t&&(stop=!0),timeTillStop=stopTime-t,stop?(stop=!(start=!0),timeTillStop=stopTime=0,intervalId=requestAnimationFrame(e)):requestAnimationFrame(e)})}function getProducts(){var t=new XMLHttpRequest;t.open("GET",window.location.origin+"/product/",!0),t.onreadystatechange=function(){if(4==t.readyState&&"200"==t.status){var e=JSON.parse(t.response);fillProducts(products=e.data)}},t.send(null)}function fillProducts(e){window.location.pathname.indexOf("online-objednavka");for(var t=0;t<e.length;t++){for(var o,n=[],r=0;r<e[t].variant.length;r++)n.push(Number(e[t].variant[r].priceMin));if(o=Math.min.apply(null,n),1==e[t].category){(a=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center cursor-pointer")).attr("onclick","orderProduct('"+e[t]._id+"')");var d=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[t].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[t].title+'">').attr("data-src",e[t].imageFilesData[0].url).appendTo(a),d.appendTo(a),$("<strong></strong").text(o+" €").appendTo($("<p class='productPrice'></p>").text("od ").appendTo(a)),a.appendTo("#productKelimky")}if(2==e[t].category){(a=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center cursor-pointer")).attr("onclick","orderProduct('"+e[t]._id+"')");d=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[t].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[t].title+'">').attr("data-src",e[t].imageFilesData[0].url).appendTo(a),d.appendTo(a),$("<strong></strong").text(o+" €").appendTo($("<p class='productPrice'></p>").text("od ").appendTo(a)),$("<p></p>").text("Cena / TODO").appendTo(a),a.appendTo("#productOdberniky")}if(3==e[t].category){var a;(a=$("<div></div>").addClass("col-lg-3 col-md-6 col-12 text-center cursor-pointer")).attr("onclick","orderProduct('"+e[t]._id+"')");d=$('<div class="prod-header"></div>').append('<h6 class="font-weight-bold">'+e[t].title+"</h6>");$('<img class="lazyload" alt="Tonap - '+e[t].title+'">').attr("data-src",e[t].imageFilesData[0].url).appendTo(a),d.appendTo(a),$("<strong></strong").text(o+" €").appendTo($("<p class='productPrice'></p>").text("od ").appendTo(a)),$("<p></p>").text("Cena / TODO").appendTo(a),a.appendTo("#productSkumavky")}}for(t=0;t<itemsNodes.length;t++)t<4?$(itemsNodes[t]).show("slow"):$(itemsNodes[t]).hide("slow")}function orderProduct(e){for(var t=document.getElementById("variantsSelect"),o=0;o<products.length;o++)if(products[o]._id==e)if(document.location.href.indexOf("online-objednavka")<0){document.getElementById("navigationOrder").innerHTML="Pridať do košíka",choosedProduct=products[o],t.innerHTML="",document.getElementById("productModalMainImage").setAttribute("src",choosedProduct.imageFilesData[0].url),document.getElementById("mainTitle").innerHTML=choosedProduct.title,document.getElementById("productDescription").innerHTML=choosedProduct.description,document.getElementById("productHeight").innerHTML="Výška: "+choosedProduct.height+" mm",document.getElementById("productDepth").innerHTML="Priemer: "+choosedProduct.gauge+" mm",document.getElementById("productVolume").innerHTML="Objem: "+choosedProduct.volume+" ml",document.getElementById("productWeight").innerHTML="Váha: "+choosedProduct.weight+" g",document.getElementById("navigationOrder").setAttribute("onclick","fillOrder('"+products[o]._id+"')");for(var n=0;n<products[o].variant.length;n++){(r=document.createElement("option")).value=products[o].variant[n].title,r.text=products[o].variant[n].title,t.appendChild(r)}document.getElementById("actualPrice").innerHTML=choosedProduct.variant[0].priceMax+" €",document.getElementById("midPrice").innerHTML=choosedProduct.variant[0].priceMed+" €",document.getElementById("lowPrice").innerHTML=choosedProduct.variant[0].priceMin+" €",refreshOrder(),getProductSum(),document.getElementById("totalProductPrice").innerHTML=totalProductPrice+" € ",$("#productModal").modal()}else{choosedProduct=products[o],t.innerHTML="",document.getElementById("productModalMainImage").setAttribute("src",choosedProduct.imageFilesData[0].url),document.getElementById("mainTitle").innerHTML=choosedProduct.title,document.getElementById("productDescription").innerHTML=choosedProduct.description,document.getElementById("productHeight").innerHTML="Výška: "+choosedProduct.height+" mm",document.getElementById("productDepth").innerHTML="Priemer: "+choosedProduct.gauge+" mm",document.getElementById("productVolume").innerHTML="Objem: "+choosedProduct.volume+" ml",document.getElementById("productWeight").innerHTML="Váha: "+choosedProduct.weight+" g";for(n=0;n<products[o].variant.length;n++){var r;(r=document.createElement("option")).value=products[o].variant[n].title,r.text=products[o].variant[n].title,t.appendChild(r)}document.getElementById("actualPrice").innerHTML=choosedProduct.variant[0].priceMax+" €",document.getElementById("midPrice").innerHTML=choosedProduct.variant[0].priceMed+" €",document.getElementById("lowPrice").innerHTML=choosedProduct.variant[0].priceMin+" €",refreshOrder(),getProductSum(),document.getElementById("totalProductPrice").innerHTML=totalProductPrice+" € ",document.getElementById("editOrder").setAttribute("onclick","fillOrder('"+products[o]._id+"')"),$("#productModal").modal()}}function fillOrder(e){orderInProgress.title=document.getElementById("mainTitle").innerHTML,orderInProgress.id=e,orderInProgress.image=document.getElementById("productModalMainImage").src,orderInProgress.count=Number(document.getElementById("countSelect").value),orderInProgress.variant=document.getElementById("variantsSelect").selectedIndex,orderInProgress.variantName=document.getElementById("variantsSelect").options[document.getElementById("variantsSelect").selectedIndex].value;var t=document.getElementById("actualPrice").innerHTML;orderInProgress.price=Number(t.replace(/€/,"")),console.log(orderInProgress),console.log(orderObject),orderObject.push(orderInProgress),localStorage.setItem("orderObject",JSON.stringify(orderObject)),orderInProgress={},$("#productModal").modal("toggle"),getSum()}function updateDetail(){var e;document.getElementById("detailOrder").innerHTML="";for(var t=0;t<orderObject.length;t++){var o=document.createElement("button"),n=document.createElement("button"),r=document.createElement("i"),d=document.createElement("i");r.className="fas fa-trash ml-3",d.className="fas fa-pen",o.type="button",o.appendChild(r),o.setAttribute("onclick","deleteOrder("+t+");"),n.type="button",n.appendChild(d),n.setAttribute("onclick","editOrder("+t+");");var a=document.createElement("td");a.className="text-center",e=$("<tr></tr>");var c=$('<td class="border-left-0 border-right-0"></td>').appendTo(e);$("<img>").attr("src",orderObject[t].image).appendTo(c),$("<td class='font-weight-bold border-left-0'></td>").html(orderObject[t].title).appendTo(e),$("<td class='font-weight-bold'></td>").html(orderObject[t].variantName).appendTo(e),$("<td class='font-weight-bold' style='color:#4187cc;'></td>").html(orderObject[t].price+" €").appendTo(e),$('<td class="border-left-0"></td>').html('<span class="font-weight-bold">'+orderObject[t].count+" ks.</span>").appendTo(e),$("<td class='font-weight-bold' style='color:#4187cc;'></td>").html(orderObject[t].price*orderObject[t].count+" €").appendTo(e),$(a).addClass("border-right-0"),$(a).append(n),$(a).append(o).appendTo(e),e.appendTo(document.getElementById("detailOrder"))}getSum()}function editOrder(e){orderProduct(orderObject[e].id),document.getElementById("editOrder").innerHTML="Zmeniť objednávku",document.getElementById("editOrder").setAttribute("onclick","updateOrder("+e+")")}function updateOrder(e){orderObject[e].title=document.getElementById("mainTitle").innerHTML,orderObject[e].count=Number(document.getElementById("countSelect").value);var t=document.getElementById("actualPrice").innerHTML;orderObject[e].price=Number(t.replace(/€/,"")),orderObject[e].variant=document.getElementById("variantsSelect").selectedIndex,orderObject[e].variantName=document.getElementById("variantsSelect").options[document.getElementById("variantsSelect").selectedIndex].value,updateDetail(),$("#productModal").modal("toggle"),localStorage.setItem("orderObject",JSON.stringify(orderObject))}function deleteOrder(e){orderObject.splice(e,1),localStorage.setItem("orderObject",JSON.stringify(orderObject)),updateDetail()}function sendOrder(){event.preventDefault();var e={};e.city=document.getElementById("companyCity").value,e.psc=document.getElementById("companyPSC").value,e.street=document.getElementById("companyAdress").value;var t={};t.city=document.getElementById("deliveryCity").value,t.psc=document.getElementById("deliveryPSC").value,t.street=document.getElementById("deliveryAdress").value;var o={};o.billingAddress=e,o.company=document.getElementById("company").value,o.deliveryAddress=t,o.name=document.getElementById("name").value,o.email=document.getElementById("email").value,o.phone=document.getElementById("phone").value,o.ico=document.getElementById("ico").value,o.message=document.getElementById("message").value,o.products=orderObject;var n=JSON.stringify(o);$.ajax({type:"POST",url:window.location.origin+"/order",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){socket.emit("order created"),$(document.getElementById("successOrder")).modal("show")}})}function sendEmail(){var e={};event.preventDefault(),e.name=document.getElementById("contactName").value,e.email=document.getElementById("contactEmail").value,e.subject=document.getElementById("contactSubject").value,e.message=document.getElementById("contactMessage").value,jsonData=JSON.stringify(e),$.ajax({type:"POST",url:window.location.origin+"/email/send",data:jsonData,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){$(document.getElementById("successEmail")).modal("show")}})}function scrollIt(e,r,d,a){var c={easeOutQuad:function(e){return e*(2-e)}},i=window.pageYOffset,l="now"in window.performance?performance.now():(new Date).getTime(),t=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),o=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight,n="number"==typeof e?e:e.offsetTop-90,s=Math.round(t-n<o?t-o:n);if("requestAnimationFrame"in window==!1)return window.scroll(0,s),void(a&&a());!function e(){var t="now"in window.performance?performance.now():(new Date).getTime(),o=Math.min(1,(t-l)/r),n=c[d](o);window.scroll(0,Math.ceil(n*(s-i)+i)),window.pageYOffset!==s?requestAnimationFrame(e):a&&a()}()}function refreshOrder(){countSelect=document.getElementById("countSelect").value,variantId=document.getElementById("variantsSelect").selectedIndex;var e=document.getElementById("actualPrice"),t=document.getElementById("midPrice"),o=document.getElementById("lowPrice");console.log(countSelect),countSelect<2e3&&(e.innerHTML=choosedProduct.variant[variantId].priceMax+" €",t.innerHTML=choosedProduct.variant[variantId].priceMed+" €",o.innerHTML=choosedProduct.variant[variantId].priceMin+" €"),2e3<=countSelect&&countSelect<4e3?(e.innerHTML=choosedProduct.variant[variantId].priceMed+" €",t.innerHTML=choosedProduct.variant[variantId].priceMed+" €",o.innerHTML=choosedProduct.variant[variantId].priceMin+" €"):4e3<=countSelect&&(e.innerHTML=choosedProduct.variant[variantId].priceMin+" €",t.innerHTML=choosedProduct.variant[variantId].priceMed+" €",o.innerHTML=choosedProduct.variant[variantId].priceMin+" €"),getProductSum(),document.getElementById("totalProductPrice").innerHTML=totalProductPrice+" € ",getSum()}function getSum(){for(var e=0,t=0;t<orderObject.length;t++)e+=orderObject[t].price*orderObject[t].count;null!=document.getElementById("cartPrice")&&(document.getElementById("cartPrice").innerHTML=e+" €"),null!=document.getElementById("medzisucet")&&(document.getElementById("medzisucet").innerHTML=e+" €")}function getProductSum(){var e=document.getElementById("actualPrice").innerHTML;console.log(countSelect),console.log(e),totalProductPrice=countSelect*Number(e.replace(/€/,""))}function getShippingPrice(){var e=$("input[name=radioName]:checked","#myForm").val();console.log(e);var t=$("input[name=radioName]:checked","#myForm").val();console.log(t)}window.onload=function(){revealProducts(),scrollPage(),getProducts(),window.location.href.indexOf("online-objednavka")<0&&setTimeout(startCounter,1e3),container=$("#pills-tabContent").find(".active"),itemsHolder=container.find(".productRowContainer"),itemsWrapper=itemsHolder[0].children[0],console.log(container),itemsNodes=itemsWrapper.childNodes,setTimeout(function(){console.log(itemsNodes)},5e3)},"function"==typeof io&&(socket=io()),1<window.location.href.indexOf("online-objednavka")&&(updateDetail(),console.log("online-objednavka"));